document.addEventListener("DOMContentLoaded",function(){const d=document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||document.querySelector('input[name="_token"]')?.value,o=document.getElementById("addSupplierForm");o&&o.addEventListener("submit",function(r){r.preventDefault();const a=new FormData(this),t=this.querySelector('button[type="submit"]'),u=t.innerHTML;t.disabled=!0,t.innerHTML='<i class="fas fa-spinner fa-spin me-1"></i>Creating...',fetch(this.action,{method:"POST",body:a,headers:{"X-Requested-With":"XMLHttpRequest","X-CSRF-TOKEN":d}}).then(e=>e.json()).then(e=>{e.success?(s("Supplier created successfully!","success"),bootstrap.Modal.getInstance(document.getElementById("addSupplierModal")).hide(),o.reset(),setTimeout(()=>window.location.reload(),1e3)):s(e.message||"Failed to create supplier","error")}).catch(e=>{console.error("Error:",e),s("An error occurred while creating the supplier","error")}).finally(()=>{t.disabled=!1,t.innerHTML=u})});const i=document.getElementById("editSupplierForm");i&&i.addEventListener("submit",function(r){r.preventDefault();const a=new FormData(this),t=this.querySelector('button[type="submit"]'),u=t.innerHTML;t.disabled=!0,t.innerHTML='<i class="fas fa-spinner fa-spin me-1"></i>Saving...',fetch(this.action,{method:"POST",body:a,headers:{"X-Requested-With":"XMLHttpRequest","X-CSRF-TOKEN":d}}).then(e=>e.json()).then(e=>{e.success?(s("Supplier updated successfully!","success"),bootstrap.Modal.getInstance(document.getElementById("editSupplierModal")).hide(),setTimeout(()=>window.location.reload(),1e3)):s(e.message||"Failed to update supplier","error")}).catch(e=>{console.error("Error:",e),s("An error occurred while updating the supplier","error")}).finally(()=>{t.disabled=!1,t.innerHTML=u})});const l=document.getElementById("deleteSupplierForm");l&&l.addEventListener("submit",function(r){r.preventDefault();const a=new FormData(this),t=this.querySelector('button[type="submit"]'),u=t.innerHTML;t.disabled=!0,t.innerHTML='<i class="fas fa-spinner fa-spin me-1"></i>Deleting...',fetch(this.action,{method:"POST",body:a,headers:{"X-Requested-With":"XMLHttpRequest","X-CSRF-TOKEN":d}}).then(e=>e.json()).then(e=>{e.success?(s("Supplier deleted successfully!","success"),bootstrap.Modal.getInstance(document.getElementById("deleteSupplierModal")).hide(),setTimeout(()=>window.location.reload(),1e3)):s(e.message||"Failed to delete supplier","error")}).catch(e=>{console.error("Error:",e),s("An error occurred while deleting the supplier","error")}).finally(()=>{t.disabled=!1,t.innerHTML=u})})});window.editSupplier=function(o,i,l,r,a,t,u){var e=document.getElementById("editSupplierForm");e&&(e.action="/suppliers/"+o);var n;n=document.getElementById("edit_name"),n&&(n.value=i||""),n=document.getElementById("edit_vat_type"),n&&(n.value=l||""),n=document.getElementById("edit_address"),n&&(n.value=r||""),n=document.getElementById("edit_contact_person"),n&&(n.value=a||""),n=document.getElementById("edit_contact_number"),n&&(n.value=t||""),n=document.getElementById("edit_tin_no"),n&&(n.value=u||""),window.bootstrap&&document.getElementById("editSupplierModal")&&new bootstrap.Modal(document.getElementById("editSupplierModal")).show()};window.deleteSupplier=function(o,i){var l=document.getElementById("deleteSupplierForm");l&&(l.action="/suppliers/"+o);var r=document.getElementById("delete_supplier_name");r&&(r.textContent=i||""),window.bootstrap&&document.getElementById("deleteSupplierModal")&&new bootstrap.Modal(document.getElementById("deleteSupplierModal")).show()};function s(d,o="info"){const i=document.createElement("div");i.className=`alert alert-${o==="error"?"danger":o} alert-dismissible fade show position-fixed`,i.style.cssText="top: 20px; right: 20px; z-index: 9999; min-width: 300px;",i.innerHTML=`
        ${d}
        <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
    `,document.body.appendChild(i),setTimeout(()=>{i.parentNode&&i.parentNode.removeChild(i)},5e3)}
